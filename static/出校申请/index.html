<html>

<head>
    <title>注会191</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="./libs/bootstrap.min.css">
    <script src="./libs/jquery.min.js"></script>
    <script src="./libs/bootstrap.min.js"></script>
    <script src="./libs/cookie.js"></script>
</head>

<body>
    <nav class="navbar navbar-top navbar-inverse" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse"
                    data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">
                        <a class="navbar-brand" href="../">返回主页</a>
                    </span>
                </button>
                <a class="navbar-brand" href="../">返回主页</a>
            </div>
        </div>
    </nav>


    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">

                <div class="page-header">
                    <h1>
                        莫的智慧请假文本生成系统Ver20201112+<small>Powered by xqqy</small>
                    </h1>
                </div>
                <dl>
                    <dd>
                        通常而言，只需正确填写时间，系统将自动给出出校申请流程。
                    </dd>
                    <hr>
                    <dt>
                        审批提示：
                    </dt>
                    <dd>
                        如四小时以上请假审批且不在周四，请同时联络班长。提前一天进行请假。在每天16:00的时候查看“掌上北工商”请假单
                    </dd>
                    <dd>
                        如掌上北工商未销假，请忽略填写掌上北工商步骤并告知班长。在16：00时再次查看是否销假
                    </dd>
                    <dd>
                        如需出京，请首先联络班长进行审批。
                    </dd>
                    <hr>
                    <dt>
                        审批流程：
                    </dt>
                    <dd>
                        1、联络你的宿舍长（宿舍长联络班长）
                    </dd>
                    <dd>
                        2、和宿舍长用下面的“大段话生成器”生成一个请假用大段话，发送给宿舍长\班长，并让他回复“同意”
                    </dd>
                    <dd>
                        3、将截图发送至问卷星系统，四小时以上请假还需要填写“掌上北工商”请假申请
                    </dd>
                    <dd>
                        4、在返校后，填写<a
                            href="https://www.wjx.cn/jq/91718594.aspx">https://www.wjx.cn/jq/91718594.aspx</a>以销假。如需第二天再请假出去请联络班长。
                    </dd>
                    <dt>
                        如有疑问，请联络班长
                    </dt>
                </dl>
                <div class="form-group">
                    <label>姓名</label><input type="text" class="form-control" id="FormName" />
                </div>
                <div class="form-group">
                    <label>学号</label><input type="text" class="form-control" id="FormUID" />
                </div>
                <div class="form-group">
                    <label>宿舍号</label><input type="text" class="form-control" id="FormSID" />
                </div>
                <div class="form-group">
                    <label>出校理由</label><input type="text" class="form-control" id="FormReason" />
                </div>
                <div class="form-group">
                    <label>出校日期</label><input type="date" class="form-control" id="FormOutDate" />
                </div>
                <div class="form-group">
                    <label>出校时间</label><input type="time" class="form-control" id="FormOutTime" />
                </div>
                <div class="form-group">
                    <label>返校时间</label><input type="date" class="form-control" id="FormInDate" />
                </div>

                <div class="form-group">
                    <label>返校时间</label><input type="time" class="form-control" id="FormInTime" />
                </div>
                <div class="form-group">
                    <label>禁用自动批准预检测和快速请假流程<input type="checkbox" id="FormForce" /></label>
                </div>
                <button type="submit" class="btn btn-default" onclick="updateform()">生成</button>
            </div>
        </div>
    </div>







    <!-- 模态框（Modal） -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalLabel">
                        生成的结果
                    </h4>
                </div>
                <div class="modal-body">
                    下面为生成的请假申请信息
                    <br>
                    -------

                    <br>
                    <br>
                    <br>
                    <span id="modalOutType"></span>商学院注会191班；姓名：<span id="modalName"></span>；学号：<span
                        id="modalUID"></span>；宿舍号：<span id="modalSID"></span>；我申请于：<span
                        id="modalOutDate"></span>&nbsp&nbsp&nbsp<span id="modalOutTime"></span>到<span
                        id="modalInDate"></span>&nbsp&nbsp&nbsp<span id="modalInTime"></span>因<span
                        id="modalReason"></span>申请出校，请予批准
                    <br>
                    <br>
                    <br>
                    -------
                    <br>
                    <span id="modalWJX" style="font-weight: bold;"></span>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal">OK
                    </button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>


</body>

</html>

<script>
    function updateform() {
        var OutTimeUnix = $.myTime.DateToUnix($('#FormOutDate').val() + ' ' + $('#FormOutTime').val() + ":00");
        var InTimeUnix = $.myTime.DateToUnix($('#FormInDate').val() + ' ' + $('#FormInTime').val() + ":00");
        
        if (OutTimeUnix > InTimeUnix && !$('#FormForce').is(':checked')) {//时间不对
            $('#modalWJX').text('系统检测到返校时间比出校时间还早，请检查上下午设置');
            $('#modalWJX').css('color','red');
            $('#myModal').modal('show');
            return;
        }
        /*if () {//标准流程请当天的假
            $('#modalWJX').text('系统检测到返校时间比出校时间还早，请检查上下午设置');
            $('#modalWJX').css('color','red');
            $('#myModal').modal('show');
            return;
        }*/
        if (InTimeUnix - OutTimeUnix <= 14400000 && !$('#FormForce').is(':checked')) {//四小时之内提示只报备，晚于23点不予批准。
            $('#modalOutType').text("四小时内出校申请：")
            if ($('#FormInTime').val().split(':')[0] == 23 || $('#FormInTime').val().split(':')[0] == 00) {
                $('#modalWJX').text('申请返校时间晚于23：00，不予批准！如确需请求，请勾选“禁用自动批准预检测和快速请假流程”');
                $('#modalWJX').css('color','red');
                $('#myModal').modal('show');
                return;
            }
            $('#modalWJX').html('申请在四个小时内，向宿舍长复制上述文字后收到“同意，已报学校备案”;将截图上传至此即可出校<a href="https://www.wjx.top/jq/97116733.aspx">https://www.wjx.top/jq/97116733.aspx</a><br>返校后填写<a href="https://www.wjx.cn/jq/91718594.aspx">https://www.wjx.cn/jq/91718594.aspx</a>以销假。');
        } else {
            $('#modalOutType').text("四小时以上出校申请：")
            $('#modalWJX').html('申请在四个小时以上，向宿舍长复制上述文字后收到“同意”;同时填写“掌上北工商”系统。将截图上传至此即可出校<a href="https://www.wjx.top/jq/97116733.aspx">https://www.wjx.top/jq/97116733.aspx</a><br>返校后填写<a href="https://www.wjx.cn/jq/91718594.aspx">https://www.wjx.cn/jq/91718594.aspx</a>以销假。');
        }
        $('#modalName').text($('#FormName').val());
        $('#modalUID').text($('#FormUID').val());
        $('#modalSID').text($('#FormSID').val());
        $('#modalOutDate').text($('#FormOutDate').val());
        $('#modalOutTime').text($('#FormOutTime').val());
        $('#modalInDate').text($('#FormInDate').val());
        $('#modalInTime').text($('#FormInTime').val());
        $('#modalReason').text($('#FormReason').val());
        $('#myModal').modal('show');

    }

</script>

<script>


    (function ($) {
        $.extend({
            myTime: {
                /**
                 * 当前时间戳
                 * @return <int>        unix时间戳(秒)
                 */
                CurTime: function () {
                    return Date.parse(new Date()) / 1000;
                },
                /**
                 * 日期 转换为 Unix时间戳
                 * @param <string> 2014-01-01 20:20:20  日期格式
                 * @return <int>        unix时间戳(秒)
                 */
                DateToUnix: function (string) {
                    return Date.parse(string)
                },
                /**
                 * 时间戳转换日期
                 * @param <int> unixTime    待时间戳(秒)
                 * @param <bool> isFull    返回完整时间(Y-m-d 或者 Y-m-d H:i:s)
                 * @param <int>  timeZone   时区
                 */
                UnixToDate: function (unixTime, isFull, timeZone) {
                    if (typeof (timeZone) == 'number') {
                        unixTime = parseInt(unixTime) + parseInt(timeZone) * 60 * 60;
                    }
                    var time = new Date(unixTime * 1000);
                    var ymdhis = "";
                    ymdhis += time.getUTCFullYear() + "-";
                    ymdhis += (time.getUTCMonth() + 1) + "-";
                    ymdhis += time.getUTCDate();
                    if (isFull === true) {
                        ymdhis += " " + time.getUTCHours() + ":";
                        ymdhis += time.getUTCMinutes() + ":";
                        ymdhis += time.getUTCSeconds();
                    }
                    return ymdhis;
                }
            }
        });
    })(jQuery);


</script>